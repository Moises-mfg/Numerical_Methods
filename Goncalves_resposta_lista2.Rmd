---
title: "Goncalves_resposta_lista1."
author: "Moisés Gonçalves"
date: "2025-01-31"
output: pdf_document
---

# Questão 1 
```{r setup, include=FALSE}
#require(ggplot2)
library(ggplot2)

set.seed(35)

#creating variables 
beta = 0.987 # intertemporal discount rate (discrete time)

mu = 2 # risk aversion

alpha = 1/3 # income of labor/ toal income 

delta = 0.012 # depreciation rate 

rho = 0.95 # persistence of the previous shock

sigma = 0.007 # variance of the white error of the shock

toler = 10^(-5)

k_ss = (1/(alpha*beta) - (1-delta)/alpha)^(1/(alpha-1))
```

```{r}
#Tauchen function
N = 9
m = 3

thetas = c(1:N)


## Upper bound of theta 

thetas[N] = m*sigma/((1-rho^2)^(1/2))

## Lower bounf of theta 
thetas[1] = -thetas[N]

delta_theta = thetas[N]/((N-1)/2)

# The other theta_ns
# This calculates the value of the intermediary thetas

for (i in 2:(N-1)){
  print(i)
  thetas[i] = thetas[1] + (i-1)*delta_theta
}
transition_matrix = matrix(,N,N)
#transition_matrix


#Probability(i,j) is given theta_i the probability of theta_j being draw in the next period

for (i in 1:N){
  for (j in 1:N){
    if (j==1){
      transition_matrix[i,j] = pnorm((thetas[j] + delta_theta/2 - rho*thetas[i])/sigma)
    }else if (j==N){
      transition_matrix[i,j] = 1 - pnorm((thetas[j] - delta_theta/2 - rho*thetas[i])/sigma)
    }else{
    transition_matrix[i,j] = pnorm((thetas[j] + delta_theta/2 - rho*thetas[i])/sigma) - pnorm((thetas[j] - delta_theta/2 - rho*thetas[i])/sigma)
    }
  }
}

```

```{r}
# Question 3
# Iteration of the value function

 
k_grid = seq(from= 0.75*k_ss, to=1.25*k_ss, length.out = 500) #Create grid for capital

z_grid = thetas # The grid of the shocks 

i =0

Vt = 0 # V_0 starts with 0
error_V_Vnew = 10 # initial error for the difference between V_t and V_t+1

# Brute force 


while (error_V_Vnew > toler){
for (k in k_grid){
  print(k)
  for(z in z_grid){
    print(z)
  }
}
  error_V_Vnew =0
}



```

